import fs from "fs";
import {ManifestPath, DependenciesCacheFilename} from "./Config.js";


function clearVersionSuffix(){
    const rawManifest = fs.readFileSync(ManifestPath);
    const manifest = JSON.parse(rawManifest.toString().trim());
    const dependencies = manifest.optionalDependencies;
    delete manifest["optionalDependencies"];

    console.log("Version: " + manifest.version);
    console.log("Manifest data: " + JSON.stringify(manifest, null, 3));
    console.log("Cache data: " + JSON.stringify(dependencies, null, 3))

    fs.writeFileSync(ManifestPath, JSON.stringify(manifest, null, 3));
    fs.writeFileSync(DependenciesCacheFilename, JSON.stringify(dependencies, null, 3));
}

clearVersionSuffix();